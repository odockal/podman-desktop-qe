# Kubernetes Deployments Page Feature Test Scenario

This scenario verifies the functionality of editing Kubernetes deployment resources.

## Prerequisites

- A Kubernetes or OpenShift cluster (can be a local setup such as Kind, Minikube, or OpenShift Local).
- Ensure you are working within the correct Kubernetes context in Podman Desktop (visible in the bottom-right corner).

## Kubernetes Deployments Page Test Scenario

1. **Navigate to the Kubernetes Page**  
   Access the Kubernetes section via the right navigation panel.

2. **Verify Cluster Connection**  
   Ensure that you are connected to a running cluster.

3. **Access Deployments**  
   Go to the **Deployments** section under Kubernetes.

4. **Apply a Deployment YAML**  
   Apply a deployment using the following YAML file:  
   [test-deployment-resource.yaml](https://github.com/odockal/podman-desktop-qe/blob/b61b9ebf948e7770c240c2f809f7bbd0dab8a51b/docs/scenarios/kubernetes/resources/test-deployment-resource.yaml)

5. **Check Deployment State**  
   - Initially, the deployment will be in a **Stopped** state because it waits until all replicas are active.  
   - You can check the replica status in the **Summary** tab of the deployment details.  
   - Once all replicas are available, the deployment will transition to **Running** state.  
   - Expected replica status:  
     - **Desired**: 3  
     - **Updated**: 3  
     - **Total**: 3  
     - **Available**: 3  
     - **Unavailable**: N/A  
   - You can also verify that all replicas are running on the **Pods** page. Pod names will follow the pattern: `deployment-name` + autogenerated suffix.

6. **Delete the Deployment**  
   After deleting the deployment, all associated pod replicas should also be removed automatically.

---

## Edit Kubernetes YAML Feature Test Scenario

1. **Open Deployment Details**  
   Use the same deployment resource applied in the previous scenario.

2. **Edit the YAML**  
   - Go to the deployment details page.  
   - Navigate to the **Kube** tab.  
   - Locate the `replicas` field in the YAML.  
   - Change the value from `3` to `5` and apply the changes.  
   - **Note**: Not all fields are editable in Kubernetes resources (e.g., `metadata.name` or `metadata.namespace` cannot be changed).  
     Editing the `replicas` field is a valid test for confirming real-time updates.

3. **Confirm the Changes**  
   - Ensure the YAML now shows `replicas: 5`.  
   - Verify that there are 5 running pod replicas for the deployment listed on the **Pods** page.

